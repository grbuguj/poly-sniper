<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>‚ö° BTC 5M Sniper</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { background:#0a0a0f; color:#e0e0e0; font-family:'Courier New',monospace; font-size:14px; padding:16px; }

        .header { display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
        .header h1 { font-size:20px; color:#f7931a; }
        .mode { padding:4px 12px; border-radius:4px; font-size:12px; font-weight:bold; }
        .mode-dry { background:#1a3a1a; color:#4ade80; border:1px solid #4ade80; }
        .mode-live { background:#3a1a1a; color:#f87171; border:1px solid #f87171; }

        .stats-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(150px,1fr)); gap:10px; margin-bottom:16px; }
        .stat-card { background:#111118; border:1px solid #222; border-radius:6px; padding:12px; text-align:center; }
        .stat-card .label { font-size:11px; color:#888; text-transform:uppercase; margin-bottom:4px; }
        .stat-card .value { font-size:22px; font-weight:bold; }
        .green { color:#4ade80; } .red { color:#f87171; } .gold { color:#f7931a; } .blue { color:#60a5fa; }

        .price-bar { background:#111118; border:1px solid #222; border-radius:6px; padding:12px; margin-bottom:16px;
                     display:flex; justify-content:space-around; align-items:center; flex-wrap:wrap; gap:8px; }
        .price-item { text-align:center; }
        .price-item .label { font-size:11px; color:#888; }
        .price-item .val { font-size:18px; font-weight:bold; }

        .status-dot { display:inline-block; width:8px; height:8px; border-radius:50%; margin-right:4px; }
        .dot-green { background:#4ade80; } .dot-red { background:#f87171; }

        table { width:100%; border-collapse:collapse; margin-top:8px; }
        th { background:#1a1a24; padding:8px 6px; text-align:left; font-size:11px; color:#888;
             text-transform:uppercase; border-bottom:1px solid #333; position:sticky; top:0; }
        td { padding:6px; border-bottom:1px solid #1a1a24; font-size:13px; white-space:nowrap; }
        tr:hover { background:#111118; }

        .badge { padding:2px 8px; border-radius:3px; font-size:11px; font-weight:bold; }
        .badge-win { background:#1a3a1a; color:#4ade80; }
        .badge-lose { background:#3a1a1a; color:#f87171; }
        .badge-pending { background:#1a1a3a; color:#60a5fa; }
        .badge-yes { background:#1a2a1a; color:#86efac; }
        .badge-no { background:#2a1a1a; color:#fca5a5; }
        .badge-fwd { background:#1a1a2a; color:#93c5fd; }
        .badge-rev { background:#2a1a2a; color:#d8b4fe; }

        .table-wrap { max-height:calc(100vh - 340px); overflow-y:auto; border:1px solid #222; border-radius:6px; }

        @media (max-width:600px) {
            .stats-grid { grid-template-columns:repeat(2,1fr); }
            td, th { padding:4px 3px; font-size:12px; }
        }
    </style>
</head>
<body>

<!-- HEADER -->
<div class="header">
    <h1>‚ö° BTC 5M Sniper</h1>
    <span th:class="${stats.dryRun()} ? 'mode mode-dry' : 'mode mode-live'"
          th:text="${stats.dryRun()} ? 'üß™ DRY-RUN' : 'üî¥ LIVE'">MODE</span>
</div>

<!-- PRICE BAR -->
<div class="price-bar">
    <div class="price-item">
        <div class="label">
            <span th:class="${stats.chainlinkConnected()} ? 'status-dot dot-green' : 'status-dot dot-red'"></span>
            Chainlink
        </div>
        <div class="val gold" th:text="'$' + ${#numbers.formatDecimal(btcPrice, 1, 2)}">$0</div>
    </div>
    <div class="price-item">
        <div class="label">5M ÏãúÏ¥àÍ∞Ä</div>
        <div class="val" th:text="'$' + ${#numbers.formatDecimal(btcOpen, 1, 2)}">$0</div>
    </div>
    <div class="price-item">
        <div class="label">Î≥ÄÎèô</div>
        <div class="val" th:with="diff=${btcOpen > 0 ? ((btcPrice - btcOpen) / btcOpen * 100) : 0}"
             th:class="${diff >= 0} ? 'green' : 'red'"
             th:text="${#numbers.formatDecimal(diff, 1, 3)} + '%'">0%</div>
    </div>
    <div class="price-item">
        <div class="label">ÌèâÍ∑† Ïä§Ï∫î</div>
        <div class="val blue" th:text="${#numbers.formatDecimal(stats.avgScanMs(), 1, 1)} + 'ms'">0ms</div>
    </div>
</div>

<!-- STATS GRID -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="label">ÏûîÏï°</div>
        <div class="value gold" th:text="'$' + ${#numbers.formatDecimal(balance, 1, 2)}">$0</div>
    </div>
    <div class="stat-card">
        <div class="label">Ï¥ù P&amp;L</div>
        <div class="value" th:class="${totalPnl >= 0} ? 'green' : 'red'"
             th:text="${#numbers.formatDecimal(totalPnl, 1, 2)}">$0</div>
    </div>
    <div class="stat-card">
        <div class="label">ÏäπÎ•†</div>
        <div class="value blue" th:text="${#numbers.formatDecimal(stats.winRate() * 100, 1, 1)} + '%'">0%</div>
    </div>
    <div class="stat-card">
        <div class="label">W / L / P</div>
        <div class="value">
            <span class="green" th:text="${winCount}">0</span> /
            <span class="red" th:text="${loseCount}">0</span> /
            <span class="blue" th:text="${pendingCount}">0</span>
        </div>
    </div>
    <div class="stat-card">
        <div class="label">Ï¥ù Ïä§Ï∫î</div>
        <div class="value" th:text="${stats.totalScans()}">0</div>
    </div>
    <div class="stat-card">
        <div class="label">Ï¥ù Î∞∞ÌåÖ</div>
        <div class="value gold" th:text="${stats.totalTrades()}">0</div>
    </div>
</div>

<!-- TRADES TABLE -->
<div class="table-wrap">
    <table>
        <thead>
        <tr>
            <th>ÏãúÍ∞Ñ</th>
            <th>Ï†ÑÎûµ</th>
            <th>Î∞©Ìñ•</th>
            <th>Î∞∞ÌåÖ</th>
            <th>Ïò§Ï¶à</th>
            <th>ÏãúÏ¥àÍ∞Ä</th>
            <th>ÏßÑÏûÖÍ∞Ä</th>
            <th>Ï¢ÖÍ∞Ä</th>
            <th>EV</th>
            <th>Í≤∞Í≥º</th>
            <th>P&amp;L</th>
            <th>ÏÜçÎèÑ</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="t : ${trades}" th:if="${t.action.name() != 'HOLD'}">
            <td th:text="${#temporals.format(t.createdAt, 'HH:mm:ss')}">00:00</td>
            <td>
                <span th:class="${t.strategy == 'FWD'} ? 'badge badge-fwd' : 'badge badge-rev'"
                      th:text="${t.strategy}">FWD</span>
            </td>
            <td>
                <span th:class="${t.action.name() == 'BUY_YES'} ? 'badge badge-yes' : 'badge badge-no'"
                      th:text="${t.action.name() == 'BUY_YES'} ? '‚ñ≤ YES' : '‚ñº NO'">YES</span>
            </td>
            <td th:text="'$' + ${#numbers.formatDecimal(t.betAmount, 1, 2)}">$0</td>
            <td th:text="${#numbers.formatDecimal(t.odds * 100, 1, 0)} + '¬¢'">50¬¢</td>
            <td th:text="'$' + ${#numbers.formatDecimal(t.openPrice, 1, 2)}">$0</td>
            <td th:text="'$' + ${#numbers.formatDecimal(t.entryPrice, 1, 2)}">$0</td>
            <td th:if="${t.exitPrice > 0}" th:text="'$' + ${#numbers.formatDecimal(t.exitPrice, 1, 2)}">$0</td>
            <td th:if="${t.exitPrice <= 0}">‚Äî</td>
            <td th:text="${#numbers.formatDecimal(t.ev * 100, 1, 1)} + '%'">0%</td>
            <td>
                <span th:if="${t.result.name() == 'WIN'}" class="badge badge-win">WIN</span>
                <span th:if="${t.result.name() == 'LOSE'}" class="badge badge-lose">LOSE</span>
                <span th:if="${t.result.name() == 'PENDING'}" class="badge badge-pending">‚è≥</span>
            </td>
            <td th:class="${t.pnl >= 0} ? 'green' : 'red'"
                th:text="${#numbers.formatDecimal(t.pnl, 1, 2)}">$0</td>
            <td th:text="${t.scanToTradeMs != null} ? ${t.scanToTradeMs} + 'ms' : '‚Äî'">‚Äî</td>
        </tr>
        </tbody>
    </table>
</div>

<!-- AUTO REFRESH -->
<script>
    setTimeout(function() { location.reload(); }, 5000);
</script>

</body>
</html>
